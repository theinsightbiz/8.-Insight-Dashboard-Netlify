<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CA Task & Billing Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container" id="appRoot">
    <header>
      <div class="title">
        <img src="logo.png" alt="Firm Logo" class="logo" />
        <span class="pill">Tasks ‚Ä¢ Deadlines ‚Ä¢ Billing</span>
      </div>
      <div class="actions">
        <button class="btn icon primary" id="addTaskBtn" aria-haspopup="dialog">‚ûï Add Task</button>
        <button class="btn icon ghost" id="bulkDeleteBtn" title="Delete selected">üóëÔ∏è Bulk Delete</button>
        <button class="btn icon ghost" id="exportCsvBtn">‚¨áÔ∏è Export CSV</button>
        <button class="btn icon ghost" id="resetDemoBtn" title="Loads demo data to Workspace">üß™ Load Demo</button>
      </div>
    </header>

    <!-- Filters / Controls -->
    <div class="controls" role="region" aria-label="Filters">
      <div class="field"><input class="input" id="searchInput" placeholder="Search client, task, assignee‚Ä¶" aria-label="Search" /></div>
      <div class="field">
        <select class="select" id="priorityFilter" aria-label="Priority filter">
          <option value="">Priority: All</option>
          <option>High</option>
          <option>Medium</option>
          <option>Low</option>
        </select>
      </div>
            <!-- Replace the old <select id="statusFilter">...</select> with this -->
<div class="field">
  <!-- hidden input keeps compatibility with existing JS -->
  <input type="hidden" id="statusFilter" value="">
  <div class="multi" id="statusMulti">
    <button type="button" class="btn icon" id="statusMultiBtn">Status: All</button>
    <div class="menu" id="statusMultiMenu" hidden>
      <label><input type="checkbox" value="Not Started"> Not Started</label>
      <label><input type="checkbox" value="In Progress"> In Progress</label>
      <label><input type="checkbox" value="Waiting Client"> Waiting Client</label>
      <label><input type="checkbox" value="On Hold"> On Hold</label>
      <label><input type="checkbox" value="Completed"> Completed</label>
      <div class="menu-actions">
        <button type="button" class="btn ghost" id="statusClearBtn">Clear</button>
        <button type="button" class="btn primary" id="statusApplyBtn">Done</button>
      </div>
    </div>
  </div>
</div>
      <div class="field">
        <select class="select" id="assigneeFilter" aria-label="Assignee filter">
          <option value="">In-Charge: All</option>
        </select>
      </div>
      <div class="field">
        <select class="select" id="monthFilter" aria-label="Month filter">
          <option value="">Month: All</option>
        </select>
      </div>
      <div class="field">
        <select class="select" id="sortBy" aria-label="Sort by">
          <option value="deadline">Sort: Deadline</option>
          <option value="createdAt">Sort: Created</option>
          <option value="priority">Sort: Priority</option>
          <option value="status">Sort: Status</option>
          <option value="fee">Sort: Fee</option>
        </select>
      </div>
      <div class="field">
        <select class="select" id="sortDir" aria-label="Sort direction">
          <option value="asc">Asc</option>
          <option value="desc">Desc</option>
        </select>
      </div>
    </div>

    <!-- Summary Cards -->
    <section class="grid" aria-label="Summary">
      <div class="card"><h3>Total Tasks</h3><div class="val" id="kpiTotal">0</div></div>
      <div class="card"><h3>Pending</h3><div class="val" id="kpiPending">0</div></div>
      <div class="card"><h3>Overdue</h3><div class="val" id="kpiOverdue">0</div></div>
      <div class="card"><h3>Fee (‚Çπ)</h3><div class="val money" id="kpiFee">0</div></div>
      <div class="card"><h3>Received (‚Çπ)</h3><div class="val money" id="kpiAdv">0</div></div>
      <div class="card"><h3>Outstanding (‚Çπ)</h3><div class="val money" id="kpiOut">0</div></div>
    </section>

    <!-- Table -->
    <table class="table" aria-label="Tasks table">
      <colgroup>
        <col class="col-check">
        <col class="col-client">
        <col class="col-task">
        <col class="col-pri">
        <col class="col-assignee">
        <col class="col-status">
        <col class="col-deadline">
        <col class="col-money">
        <col class="col-money">
        <col class="col-money">
        <col class="col-invoice">
        <col class="col-actions">
      </colgroup>
      <thead class="thead">
        <tr>
          <th><input type="checkbox" id="selectAll"></th>
          <th>Client</th>
          <th>Task</th>
          <th>Priority</th>
          <th>In-Charge</th>
          <th>Status</th>
          <th>Deadline</th>
          <th>Fee</th>
          <th>Received</th>
          <th>Outstanding</th>
          <th>Invoice Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="taskTbody"></tbody>
    </table>

    <footer class="note">Insight at work: organize, analyze, achieve.</footer>
  </div>

  <!-- Modal: Add/Edit Task -->
  <div class="modal" id="taskModal" role="dialog" aria-modal="true" aria-labelledby="taskModalTitle">
    <div class="dialog">
      <header>
        <h2 id="taskModalTitle">New Task</h2>
      </header>
      <form id="taskForm">
        <div class="body">
          <div class="dialog grid2">
            <div>
              <label>Client Name</label>
              <input required id="fClient" placeholder="Client / Entity" />
            </div>
            <div>
              <label>Task Title</label>
              <input required id="fTitle" placeholder="e.g., GSTR‚Äë1 Filing" />
            </div>
            <div>
              <label>Priority</label>
              <select id="fPriority" required>
                <option>High</option>
                <option selected>Medium</option>
                <option>Low</option>
              </select>
            </div>
            <div>
              <label>In‚ÄëCharge</label>
              <input required id="fAssignee" placeholder="Team member" />
            </div>
            <div>
              <label>Status</label>
              <select id="fStatus" required>
                <option>Not Started</option>
                <option selected>In Progress</option>
                <option>Waiting Client</option>
                <option>On Hold</option>
                <option>Completed</option>
              </select>
            </div>
            <div>
              <label>Deadline</label>
              <input type="date" id="fDeadline" required />
            </div>
            <div>
              <label>Fee (‚Çπ)</label>
              <input type="number" step="0.01" min="0" id="fFee" required />
            </div>
            <div>
              <label>Received (‚Çπ)</label>
              <input type="number" step="0.01" min="0" id="fAdvance" value="0" />
            </div>
            <div>
              <label>Invoice Status</label>
  <select id="fInvoiceStatus">
    <option value="">Select status‚Ä¶</option>
    <option>Not Raised</option>
    <option>Sent</option>
    <option>Paid</option>
    <option>Partially Paid</option>
  </select>
</div>
            <div>
              <label>Notes / Description</label>
              <textarea id="fNotes" placeholder="Brief details, documents pending, etc."></textarea>
            </div>
            <div>
              <label><input type="checkbox" id="fRecurring" /> Recurring monthly</label>
              <small class="hint">If checked, this becomes a template. The app will auto‚Äëcreate monthly instances on the same day as the deadline.</small>
            </div>
          </div>
        </div>
        <footer>
          <button type="button" class="btn ghost" id="cancelBtn">Cancel</button>
          <button class="btn primary" type="submit" id="saveBtn">Save Task</button>
        </footer>
      </form>
    </div>
  </div>

  <!-- Only addition: Firebase compat SDK before your original script -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
  <!-- Your existing app code below (unchanged references) -->
  <script src="script.js"></script>
</body>
</html>